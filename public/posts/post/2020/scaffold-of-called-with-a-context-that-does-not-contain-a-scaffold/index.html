<!DOCTYPE html>
<html lang="zh-CN"
  x-data
  :class="$store.darkMode.class()"
  :data-theme="$store.darkMode.theme()">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scaffold.of() called with a context that does not contain a Scaffold | 阿航的技术小站</title>

    

<link rel="canonical" href="http://localhost:1313/posts/post/2020/scaffold-of-called-with-a-context-that-does-not-contain-a-scaffold/" />



<meta name="author" content="" />
<meta name="description" content="今天阿航在研究底部弹出提示showSnackBar()组件时碰到了这个报错:
Scaffold.of() called with a context that does not contain a Scaffold. 本篇文章就来记录下这种报错该如何解决!
问题原因 完整报错日志:
════════ Exception caught by gesture ═══════════════════════════════════════════════════════════════ The following assertion was thrown while handling a gesture: Scaffold.of() called with a context that does not contain a Scaffold. No Scaffold ancestor could be found starting from the context that was passed to Scaffold.of(). This usually happens when the context provided is from the same StatefulWidget as that whose build function actually creates the Scaffold widget being sought. There are several ways to avoid this problem. The simplest is to use a Builder to get a context that is &#34;under&#34; the Scaffold. For an example of this, please see the documentation for Scaffold.of(): 先来看下阿航出错的源码:
" />


<meta name="keywords" content="Flutter">



<meta name="generator" content="Hugo 0.145.0">


<meta property="og:url" content="http://localhost:1313/posts/post/2020/scaffold-of-called-with-a-context-that-does-not-contain-a-scaffold/">
  <meta property="og:site_name" content="阿航的技术小站">
  <meta property="og:title" content="Scaffold.of() called with a context that does not contain a Scaffold">
  <meta property="og:description" content="今天阿航在研究底部弹出提示showSnackBar()组件时碰到了这个报错:
Scaffold.of() called with a context that does not contain a Scaffold. 本篇文章就来记录下这种报错该如何解决!
问题原因 完整报错日志:
════════ Exception caught by gesture ═══════════════════════════════════════════════════════════════ The following assertion was thrown while handling a gesture: Scaffold.of() called with a context that does not contain a Scaffold. No Scaffold ancestor could be found starting from the context that was passed to Scaffold.of(). This usually happens when the context provided is from the same StatefulWidget as that whose build function actually creates the Scaffold widget being sought. There are several ways to avoid this problem. The simplest is to use a Builder to get a context that is &#34;under&#34; the Scaffold. For an example of this, please see the documentation for Scaffold.of(): 先来看下阿航出错的源码:">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-05-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-05-29T00:00:00+00:00">
    <meta property="article:tag" content="Flutter">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Scaffold.of() called with a context that does not contain a Scaffold">
  <meta name="twitter:description" content="今天阿航在研究底部弹出提示showSnackBar()组件时碰到了这个报错:
Scaffold.of() called with a context that does not contain a Scaffold. 本篇文章就来记录下这种报错该如何解决!
问题原因 完整报错日志:
════════ Exception caught by gesture ═══════════════════════════════════════════════════════════════ The following assertion was thrown while handling a gesture: Scaffold.of() called with a context that does not contain a Scaffold. No Scaffold ancestor could be found starting from the context that was passed to Scaffold.of(). This usually happens when the context provided is from the same StatefulWidget as that whose build function actually creates the Scaffold widget being sought. There are several ways to avoid this problem. The simplest is to use a Builder to get a context that is &#34;under&#34; the Scaffold. For an example of this, please see the documentation for Scaffold.of(): 先来看下阿航出错的源码:">




<link rel="stylesheet" href="/css/output.css" />




    


<style>
  pre {
    padding: 1em;
    overflow: auto;
  }
</style>









    

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  </head>

  <body x-data="{
    flip: false,
  }">
    
    <div id="dream-global-bg"></div>

    
<nav class="mt-4 lg:mt-8 py-4">

  
  <div class="container flex justify-between px-4">
  
    <section class="flex items-center gap-4">
      <div class="avatar cursor-pointer hover:online" @click="flip = !flip" title="Flip it!">
        <div class="h-10 rounded-full">
          <img src="/" alt="" />
        </div>
      </div>

      
    </section>

    <div class="dropdown dropdown-end sm:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-square" aria-label="Select an option">
        <ion-icon name="menu" class="text-2xl"></ion-icon>
      </div>
      <ul tabindex="0" class="dropdown-content menu w-36 bg-base-100 rounded-box z-[1] shadow-md">
        

















<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/posts" title="Archives">
    <ion-icon name="archive"></ion-icon>
    Archives
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/categories" title="All Categories">
    <ion-icon name="grid"></ion-icon>
    All Categories
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/tags" title="All Tags">
    <ion-icon name="pricetags"></ion-icon>
    All Tags
  </a>
</li>






      </ul>
    </div>
    <section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4">
      
      

      

      
      





      
      





      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/posts" title="Archives">
  <ion-icon class="group-hover:text-primary-content" name="archive"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/categories" title="All Categories">
  <ion-icon class="group-hover:text-primary-content" name="grid"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/tags" title="All Tags">
  <ion-icon class="group-hover:text-primary-content" name="pricetags"></ion-icon>
</a>


      

      

      
    </section>
  </div>
</nav>


    <div class="flip-container" :class="{ 'flip-it': flip }">
      <div class="flipper">
        <div class="front">
          <div class="container">
            
<div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4">
  <div class="hidden lg:block">
    
  </div>

  <div class="lg:col-span-2">
    <article class="mx-auto prose prose-quoteless dark:prose-invert" id="dream-single-post-main" itemscope itemtype="http://schema.org/Article">
      
  <meta itemprop="name" content="Scaffold.of() called with a context that does not contain a Scaffold">
  <meta itemprop="description" content="今天阿航在研究底部弹出提示showSnackBar()组件时碰到了这个报错:
Scaffold.of() called with a context that does not contain a Scaffold. 本篇文章就来记录下这种报错该如何解决!
问题原因 完整报错日志:
════════ Exception caught by gesture ═══════════════════════════════════════════════════════════════ The following assertion was thrown while handling a gesture: Scaffold.of() called with a context that does not contain a Scaffold. No Scaffold ancestor could be found starting from the context that was passed to Scaffold.of(). This usually happens when the context provided is from the same StatefulWidget as that whose build function actually creates the Scaffold widget being sought. There are several ways to avoid this problem. The simplest is to use a Builder to get a context that is &#34;under&#34; the Scaffold. For an example of this, please see the documentation for Scaffold.of(): 先来看下阿航出错的源码:">
  <meta itemprop="datePublished" content="2020-05-29T00:00:00+00:00">
  <meta itemprop="dateModified" content="2020-05-29T00:00:00+00:00">
  <meta itemprop="wordCount" content="450">
  <meta itemprop="keywords" content="Flutter">

      <header>
        <h1 itemprop="headline">Scaffold.of() called with a context that does not contain a Scaffold</h1>
        <p class="text-sm">
          
            Friday, May 29, 2020
          

          | <span>3 minute read</span>

          
          | <span>Updated at
            
              Friday, May 29, 2020
            </span>
          
        </p>

        
        <div class="flex justify-between">
          

          <div class="flex items-center gap-2">
  
  

  
  
  
  
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://x.com/intent/post?text=Scaffold.of%28%29%20called%20with%20a%20context%20that%20does%20not%20contain%20a%20Scaffold&amp;url=http://localhost:1313/posts/post/2020/scaffold-of-called-with-a-context-that-does-not-contain-a-scaffold/" target="_blank" rel="noopener noreferrer"
      title="Share on X">
      <ion-icon class="group-hover:text-primary-content" name="logo-x"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://facebook.com/sharer/sharer.php?u=http://localhost:1313/posts/post/2020/scaffold-of-called-with-a-context-that-does-not-contain-a-scaffold/" target="_blank" rel="noopener noreferrer"
      title="Share on Facebook">
      <ion-icon class="group-hover:text-primary-content" name="logo-facebook"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://wa.me/?text=Scaffold.of%28%29%20called%20with%20a%20context%20that%20does%20not%20contain%20a%20Scaffold%20http://localhost:1313/posts/post/2020/scaffold-of-called-with-a-context-that-does-not-contain-a-scaffold/" target="_blank" rel="noopener noreferrer"
      title="Share on WhatsApp">
      <ion-icon class="group-hover:text-primary-content" name="logo-whatsapp"></ion-icon>
    </a>
  

  
  
</div>

        </div>
      </header>

      <section id="dream-single-post-content" itemprop="articleBody">
        

        <p>今天阿航在研究底部弹出提示<code>showSnackBar()</code>组件时碰到了这个报错:</p>
<pre tabindex="0"><code>Scaffold.of() called with a context that does not contain a Scaffold.
</code></pre><p>本篇文章就来记录下这种报错该如何解决!</p>
<h2 id="问题原因">问题原因</h2>
<p>完整报错日志:</p>
<pre tabindex="0"><code>════════ Exception caught by gesture ═══════════════════════════════════════════════════════════════
The following assertion was thrown while handling a gesture:
Scaffold.of() called with a context that does not contain a Scaffold.

No Scaffold ancestor could be found starting from the context that was passed to Scaffold.of(). This usually happens when the context provided is from the same StatefulWidget as that whose build function actually creates the Scaffold widget being sought.

There are several ways to avoid this problem. The simplest is to use a Builder to get a context that is &#34;under&#34; the Scaffold. For an example of this, please see the documentation for Scaffold.of():
</code></pre><p>先来看下阿航出错的源码:</p>
<pre tabindex="0"><code>import &#39;package:flutter/material.dart&#39;;

void main() =&gt; runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: &#39;Flutter Demo&#39;,
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(title: &#39;Flutter Demo Home Page&#39;),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);
  final String title;

  @override
  _MyHomePageState createState() =&gt; _MyHomePageState();
}

class _MyHomePageState extends State {

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            RaisedButton(
              child: Text(&#34;弹出&#34;),
              onPressed: () {
                Scaffold.of(context).showSnackBar(SnackBar(
                  content: Text(&#34;你今天真好看&#34;),
                ));
              },
            )
          ],
        ),
      ),
    );
  }
}
</code></pre><p>其中, 报错的重点是:</p>
<pre tabindex="0"><code>Scaffold.of(context).showSnackBar(SnackBar(
  content: Text(&#34;你今天真好看&#34;),
));
</code></pre><p>问题的可能原因是: <code>Scaffold.of(context)</code>中传入的<code>context</code>并非是所需的<code>context</code>, 被<code>build</code>函数顶替了!</p>
<p>[epcl_box type=&ldquo;information&rdquo;]速度快的同学可以直接看下面的核心代码![/epcl_box]</p>
<h2 id="解决方案">解决方案</h2>
<h3 id="方法一-使用builder">方法一: 使用Builder</h3>
<p>进行代码替换:</p>
<pre tabindex="0"><code>- body: Center(
+ body: Builder(
+   builder: (context) =&gt; Center(
    child: Column(
      mainAxisAlignment: MainAxisAlignment.center,
      children: [
        RaisedButton(
          child: Text(&#34;弹出&#34;),
          onPressed: () {
            Scaffold.of(context).showSnackBar(SnackBar(
              content: Text(&#34;你今天真好看&#34;),
            ));
          },
        )
      ],
+   ),
  ));
</code></pre>


  <blockquote>
    <p>💡 代码解析: 实际上, 我们只是在<code>Center</code>外面套了一层<code>Builder()</code>. 这样就可以使正确的<code>context</code>传入<code>snackBar</code>.</p>
  </blockquote>

<p>但是, 这样对代码的改动比较大, 并且变更了结构. 这是典型的&quot;丑代码&quot;. 我们再来介绍另一种方法.</p>
<h3 id="方法二-使用globalkey推荐">方法二: 使用GlobalKey(推荐)</h3>
<p>我们在<code>_MyHomePageState</code>中添加一个实例变量:</p>
<pre tabindex="0"><code>final _scaffoldKey = GlobalKey();
</code></pre><p>如图:</p>
<p><img src="images/Scaffold.of-called-with-a-context-01.png" alt=""></p>
<p>先在<code>Scaffold</code>对象内添加一条属性:</p>
<pre tabindex="0"><code>key: _scaffoldKey,
</code></pre><p>之后, 替换之前的:</p>
<pre tabindex="0"><code>Scaffold.of(context).showSnackBar(SnackBar(
  content: Text(&#34;你今天真好看&#34;),
));
</code></pre><p>为:</p>
<pre tabindex="0"><code>_scaffoldKey.currentState.showSnackBar(SnackBar(
  content: Text(&#34;你今天真好看&#34;),
));
</code></pre><p>修改如图:</p>
<p><img src="images/Scaffold.of-called-with-a-context-02.png" alt=""></p>



  <blockquote>
    <p>💡 代码解析: 这里首先创建了一个<code>GlobalKey</code>类型的<code>_scaffoldKey</code>实例变量, 将当前<code>Scaffold</code>对象的key进行绑定. 之后再次通过该<code>_scaffoldKey</code>调用<code>showSnackBar</code>函数.</p>
  </blockquote>

<p>这样做的一大好处就是直接消除了调用位置的限制! 只要变量能被引用, 就可以直接调用其<code>showSnackBar</code>.</p>
<p>全部代码, 你可以直接运行:</p>
<pre tabindex="0"><code>import &#39;package:flutter/material.dart&#39;;

void main() =&gt; runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: &#39;Flutter Demo&#39;,
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(title: &#39;Flutter Demo Home Page&#39;),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);
  final String title;

  @override
  _MyHomePageState createState() =&gt; _MyHomePageState();
}

class _MyHomePageState extends State {
  final _scaffoldKey = GlobalKey();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
        key: _scaffoldKey,
        appBar: AppBar(
          title: Text(widget.title),
        ),
        body: Center(
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              RaisedButton(
                child: Text(&#34;弹出&#34;),
                onPressed: () {
                  _scaffoldKey.currentState.showSnackBar(SnackBar(
                    content: Text(&#34;你今天真好看&#34;),
                  ));
                },
              )
            ],
          ),
        ));
  }
}
</code></pre><h2 id="核心代码">核心代码</h2>
<h3 id="方法一">方法一</h3>
<p>在你的组件外层包裹:</p>
<pre tabindex="0"><code>Builder(
   builder: (context) =&gt;
    // 你之前的代码
)
</code></pre><h3 id="方法二">方法二</h3>
<p>首先定义<code>GlobalKey</code>:</p>
<pre tabindex="0"><code>final _scaffoldKey = GlobalKey();
</code></pre><p>然后在<code>Scaffold</code>中绑定<code>key</code>:</p>
<pre tabindex="0"><code>Scaffold(
  key: _scaffoldKey,
  // ...
</code></pre><p>之后通过key调用<code>snackBar</code>:</p>
<pre tabindex="0"><code>_scaffoldKey.currentState.showSnackBar(SnackBar(
  content: Text(&#34;你今天真好看&#34;),
));
</code></pre><h2 id="感谢">感谢</h2>
<p><a href="https://stackoverflow.com/questions/51304568/scaffold-of-called-with-a-context-that-does-not-contain-a-scaffold" target="_blank">Scaffold.of() called with a context that does not contain a Scaffold - Stack Overflow</a>
</p>


        
      </section>

      

      
    </article>
  </div>

  <div class="hidden lg:flex lg:flex-col lg:items-end">
    
  </div>
</div>


            
<footer class="flex justify-between items-center gap-2 px-4 py-12">

  <div>
  
  <p>© 2025 阿航的技术小站</p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
        <div class="back">
          <div class="container">
            
            <div class="dream-grid dream-grid-about">
  

  

  
</div>

            

            
<footer class="flex justify-between items-center gap-2 px-4 py-12">

  <div>
  
  <p>© 2025 阿航的技术小站</p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
      </div>
    </div>

    <script>
  window.lightTheme =  null 
  window.darkTheme =  null 
</script>


  <script src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>

  
  
  <script src="/js/grid.js"></script>




<script src="/js/main.js"></script>

    









    

    

    

    

    <script type="module" src="https://unpkg.com/ionicons@7.4.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.4.0/dist/ionicons/ionicons.js"></script>
  </body>
</html>
