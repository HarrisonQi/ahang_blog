<!DOCTYPE html>
<html lang="zh-CN"
  x-data
  :class="$store.darkMode.class()"
  :data-theme="$store.darkMode.theme()">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flutter 数据存储 SharedPreferences | 阿航的技术小站</title>

    

<link rel="canonical" href="http://localhost:1313/posts/post/2020/flutter-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-sharedpreferences/" />



<meta name="author" content="" />
<meta name="description" content="我们在做APP开发时, 经常会涉及到用户的 数据存储(比如保存用户登录token、用户的某些偏好设置等). 开发过Android的朋友应该知道有 SharedPreferences. 在 Flutter 中, 同样为我们提供了十分相似的(甚至名字都一样)组件, 为我们提供数据存储的能力.
本篇教程将用一个简单的小Demo, 让你完全掌握 数据存储之SharedPreferences 的用法.
若图片展示异常, 请访问我的官方博客 效果 有图有真相, 我们先来看一下我们最终的效果:
SharedPreferences最终效果
仓库地址 所有源码(含注释)均已上传至开源仓库:
Github 码云 准备工作 开发环境 本博客的环境一览:
环境 版本号 Flutter 1.14.6 beta Dart 2.8.0-dev.5.0 Android Studio 3.5.2 注意您的环境和文中的差异, 避免出现不兼容的情况哦!
需具备的条件 要顺利阅读本文, 假定您已经具备以下条件:
一台电脑(能同时运行IDE、APP模拟器). Android Studio 或 VSCode(或任何你喜欢的代码编辑器). Flutter开发环境. 您掌握了Flutter的开发基础(至少了解目录结构、Dart语言基本知识). 实战开始 创建Flutter项目 创建一个新的Flutter项目, 命名为my_shared_preferences_demo(您可以随意起名, 但是在下面也要替换名字为您自己的).
" />


<meta name="keywords" content="App开发,Flutter">



<meta name="generator" content="Hugo 0.145.0">


<meta property="og:url" content="http://localhost:1313/posts/post/2020/flutter-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-sharedpreferences/">
  <meta property="og:site_name" content="阿航的技术小站">
  <meta property="og:title" content="Flutter 数据存储 SharedPreferences">
  <meta property="og:description" content="我们在做APP开发时, 经常会涉及到用户的 数据存储(比如保存用户登录token、用户的某些偏好设置等). 开发过Android的朋友应该知道有 SharedPreferences. 在 Flutter 中, 同样为我们提供了十分相似的(甚至名字都一样)组件, 为我们提供数据存储的能力.
本篇教程将用一个简单的小Demo, 让你完全掌握 数据存储之SharedPreferences 的用法.
若图片展示异常, 请访问我的官方博客 效果 有图有真相, 我们先来看一下我们最终的效果:
SharedPreferences最终效果
仓库地址 所有源码(含注释)均已上传至开源仓库:
Github 码云 准备工作 开发环境 本博客的环境一览:
环境 版本号 Flutter 1.14.6 beta Dart 2.8.0-dev.5.0 Android Studio 3.5.2 注意您的环境和文中的差异, 避免出现不兼容的情况哦!
需具备的条件 要顺利阅读本文, 假定您已经具备以下条件:
一台电脑(能同时运行IDE、APP模拟器). Android Studio 或 VSCode(或任何你喜欢的代码编辑器). Flutter开发环境. 您掌握了Flutter的开发基础(至少了解目录结构、Dart语言基本知识). 实战开始 创建Flutter项目 创建一个新的Flutter项目, 命名为my_shared_preferences_demo(您可以随意起名, 但是在下面也要替换名字为您自己的).">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-04-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-04-09T00:00:00+00:00">
    <meta property="article:tag" content="App开发">
    <meta property="article:tag" content="Flutter">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Flutter 数据存储 SharedPreferences">
  <meta name="twitter:description" content="我们在做APP开发时, 经常会涉及到用户的 数据存储(比如保存用户登录token、用户的某些偏好设置等). 开发过Android的朋友应该知道有 SharedPreferences. 在 Flutter 中, 同样为我们提供了十分相似的(甚至名字都一样)组件, 为我们提供数据存储的能力.
本篇教程将用一个简单的小Demo, 让你完全掌握 数据存储之SharedPreferences 的用法.
若图片展示异常, 请访问我的官方博客 效果 有图有真相, 我们先来看一下我们最终的效果:
SharedPreferences最终效果
仓库地址 所有源码(含注释)均已上传至开源仓库:
Github 码云 准备工作 开发环境 本博客的环境一览:
环境 版本号 Flutter 1.14.6 beta Dart 2.8.0-dev.5.0 Android Studio 3.5.2 注意您的环境和文中的差异, 避免出现不兼容的情况哦!
需具备的条件 要顺利阅读本文, 假定您已经具备以下条件:
一台电脑(能同时运行IDE、APP模拟器). Android Studio 或 VSCode(或任何你喜欢的代码编辑器). Flutter开发环境. 您掌握了Flutter的开发基础(至少了解目录结构、Dart语言基本知识). 实战开始 创建Flutter项目 创建一个新的Flutter项目, 命名为my_shared_preferences_demo(您可以随意起名, 但是在下面也要替换名字为您自己的).">




<link rel="stylesheet" href="/css/output.css" />




    


<style>
  pre {
    padding: 1em;
    overflow: auto;
  }
</style>









    

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  </head>

  <body x-data="{
    flip: false,
  }">
    
    <div id="dream-global-bg"></div>

    
<nav class="mt-4 lg:mt-8 py-4">

  
  <div class="container flex justify-between px-4">
  
    <section class="flex items-center gap-4">
      <div class="avatar cursor-pointer hover:online" @click="flip = !flip" title="Flip it!">
        <div class="h-10 rounded-full">
          <img src="/" alt="" />
        </div>
      </div>

      
    </section>

    <div class="dropdown dropdown-end sm:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-square" aria-label="Select an option">
        <ion-icon name="menu" class="text-2xl"></ion-icon>
      </div>
      <ul tabindex="0" class="dropdown-content menu w-36 bg-base-100 rounded-box z-[1] shadow-md">
        

















<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/posts" title="Archives">
    <ion-icon name="archive"></ion-icon>
    Archives
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/categories" title="All Categories">
    <ion-icon name="grid"></ion-icon>
    All Categories
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/tags" title="All Tags">
    <ion-icon name="pricetags"></ion-icon>
    All Tags
  </a>
</li>






      </ul>
    </div>
    <section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4">
      
      

      

      
      





      
      





      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/posts" title="Archives">
  <ion-icon class="group-hover:text-primary-content" name="archive"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/categories" title="All Categories">
  <ion-icon class="group-hover:text-primary-content" name="grid"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/tags" title="All Tags">
  <ion-icon class="group-hover:text-primary-content" name="pricetags"></ion-icon>
</a>


      

      

      
    </section>
  </div>
</nav>


    <div class="flip-container" :class="{ 'flip-it': flip }">
      <div class="flipper">
        <div class="front">
          <div class="container">
            
<div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4">
  <div class="hidden lg:block">
    
  </div>

  <div class="lg:col-span-2">
    <article class="mx-auto prose prose-quoteless dark:prose-invert" id="dream-single-post-main" itemscope itemtype="http://schema.org/Article">
      
  <meta itemprop="name" content="Flutter 数据存储 SharedPreferences">
  <meta itemprop="description" content="我们在做APP开发时, 经常会涉及到用户的 数据存储(比如保存用户登录token、用户的某些偏好设置等). 开发过Android的朋友应该知道有 SharedPreferences. 在 Flutter 中, 同样为我们提供了十分相似的(甚至名字都一样)组件, 为我们提供数据存储的能力.
本篇教程将用一个简单的小Demo, 让你完全掌握 数据存储之SharedPreferences 的用法.
若图片展示异常, 请访问我的官方博客 效果 有图有真相, 我们先来看一下我们最终的效果:
SharedPreferences最终效果
仓库地址 所有源码(含注释)均已上传至开源仓库:
Github 码云 准备工作 开发环境 本博客的环境一览:
环境 版本号 Flutter 1.14.6 beta Dart 2.8.0-dev.5.0 Android Studio 3.5.2 注意您的环境和文中的差异, 避免出现不兼容的情况哦!
需具备的条件 要顺利阅读本文, 假定您已经具备以下条件:
一台电脑(能同时运行IDE、APP模拟器). Android Studio 或 VSCode(或任何你喜欢的代码编辑器). Flutter开发环境. 您掌握了Flutter的开发基础(至少了解目录结构、Dart语言基本知识). 实战开始 创建Flutter项目 创建一个新的Flutter项目, 命名为my_shared_preferences_demo(您可以随意起名, 但是在下面也要替换名字为您自己的).">
  <meta itemprop="datePublished" content="2020-04-09T00:00:00+00:00">
  <meta itemprop="dateModified" content="2020-04-09T00:00:00+00:00">
  <meta itemprop="wordCount" content="514">
  <meta itemprop="keywords" content="App开发,Flutter">

      <header>
        <h1 itemprop="headline">Flutter 数据存储 SharedPreferences</h1>
        <p class="text-sm">
          
            Thursday, Apr 9, 2020
          

          | <span>3 minute read</span>

          
          | <span>Updated at
            
              Thursday, Apr 9, 2020
            </span>
          
        </p>

        
        <div class="flex justify-between">
          

          <div class="flex items-center gap-2">
  
  

  
  
  
  
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://x.com/intent/post?text=Flutter%20%e6%95%b0%e6%8d%ae%e5%ad%98%e5%82%a8%20SharedPreferences&amp;url=http://localhost:1313/posts/post/2020/flutter-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-sharedpreferences/" target="_blank" rel="noopener noreferrer"
      title="Share on X">
      <ion-icon class="group-hover:text-primary-content" name="logo-x"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://facebook.com/sharer/sharer.php?u=http://localhost:1313/posts/post/2020/flutter-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-sharedpreferences/" target="_blank" rel="noopener noreferrer"
      title="Share on Facebook">
      <ion-icon class="group-hover:text-primary-content" name="logo-facebook"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://wa.me/?text=Flutter%20%e6%95%b0%e6%8d%ae%e5%ad%98%e5%82%a8%20SharedPreferences%20http://localhost:1313/posts/post/2020/flutter-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-sharedpreferences/" target="_blank" rel="noopener noreferrer"
      title="Share on WhatsApp">
      <ion-icon class="group-hover:text-primary-content" name="logo-whatsapp"></ion-icon>
    </a>
  

  
  
</div>

        </div>
      </header>

      <section id="dream-single-post-content" itemprop="articleBody">
        

        <p>我们在做APP开发时, 经常会涉及到用户的 数据存储(比如保存用户登录token、用户的某些偏好设置等). 开发过Android的朋友应该知道有 SharedPreferences. 在 Flutter 中, 同样为我们提供了十分相似的(甚至名字都一样)组件, 为我们提供数据存储的能力.</p>
<p>本篇教程将用一个简单的小Demo, 让你完全掌握 数据存储之SharedPreferences 的用法.</p>



  <blockquote>
    <p>若图片展示异常, 请访问我的<a href="https://blog.bugcatt.com/archives/165" target="_blank">官方博客</a>
</p>
  </blockquote>

<h2 id="效果">效果</h2>
<p>有图有真相, 我们先来看一下我们最终的效果:</p>
<!-- raw HTML omitted -->
<p><img src="images/SharedPreferences%E6%9C%80%E7%BB%88%E6%95%88%E6%9E%9C.gif" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>SharedPreferences最终效果</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="仓库地址">仓库地址</h2>
<p>所有源码(含注释)均已上传至开源仓库:</p>
<ul>
<li><a href="https://github.com/HarrisonQi/flutter-actual-combat-demo/tree/master/my_shared_preferences_demo" target="_blank">Github</a>
</li>
<li><a href="https://gitee.com/HarrisonQI/flutter-actual-combat-demo/tree/master/my_shared_preferences_demo" target="_blank">码云</a>
</li>
</ul>
<h2 id="准备工作">准备工作</h2>
<h3 id="开发环境">开发环境</h3>
<p>本博客的环境一览:</p>
<table>
  <thead>
      <tr>
          <th>环境</th>
          <th>版本号</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Flutter</td>
          <td>1.14.6 beta</td>
      </tr>
      <tr>
          <td>Dart</td>
          <td>2.8.0-dev.5.0</td>
      </tr>
      <tr>
          <td>Android Studio</td>
          <td>3.5.2</td>
      </tr>
  </tbody>
</table>



  <blockquote>
    <p>注意您的环境和文中的差异, 避免出现不兼容的情况哦!</p>
  </blockquote>

<h3 id="需具备的条件">需具备的条件</h3>
<p>要顺利阅读本文, 假定您已经具备以下条件:</p>
<ol>
<li>一台电脑(能同时运行IDE、APP模拟器).</li>
<li><code>Android Studio</code> 或 <code>VSCode</code>(或任何你喜欢的代码编辑器).</li>
<li><code>Flutter</code>开发环境.</li>
<li>您掌握了<code>Flutter</code>的开发基础(至少了解目录结构、<code>Dart</code>语言基本知识).</li>
</ol>
<h2 id="实战开始">实战开始</h2>
<h3 id="创建flutter项目">创建Flutter项目</h3>
<p>创建一个新的Flutter项目, 命名为<code>my_shared_preferences_demo</code>(您可以随意起名, 但是在下面也要替换名字为您自己的).</p>



  <blockquote>
    <p>注意: Flutter项目名不要和引入的某个第三方库重名, 否则会报: <code>A package may not list itself as a dependency</code> 详见<a href="https://blog.bugcatt.com/archives/208" target="_blank">这里</a>
</p>
  </blockquote>

<p>代码截图:</p>
<!-- raw HTML omitted -->
<p><img src="images/%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE.png" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>初始化项目</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h3 id="清理代码">清理代码</h3>
<p>因为我们的项目过于简单, 暂时不需要进行测试. 删除./test目录:</p>
<!-- raw HTML omitted -->
<p><img src="images/%E6%B8%85%E7%90%86test%E7%9B%AE%E5%BD%95.png" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>清理test目录</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>避免冗余代码误导我们, 替换<code>./lib/main.dart</code>为:</p>
<pre tabindex="0"><code>import &#39;package:flutter/material.dart&#39;;

void main() =&gt; runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: &#39;SharedPreferences Demo&#39;,
      home: MyHomePage(title: &#39;SharedPreferences Demo Page&#39;),
    );
  }
}

class MyHomePage extends StatefulWidget {
  MyHomePage({Key key, this.title}) : super(key: key);
  final String title;

  @override
  _MyHomePageState createState() =&gt; _MyHomePageState();
}

class _MyHomePageState extends State {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(widget.title),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [],
        ),
      ),
    );
  }
}
</code></pre><h3 id="导入-sharedpreferences-第三方库">导入 SharedPreferences 第三方库</h3>
<p>进入<code>./pubspec.yaml</code>, 添加依赖:</p>
<pre tabindex="0"><code>dependencies:
  shared_preferences: ^0.5.6+3
</code></pre>


  <blockquote>
    <p>你也可以去官网查看<a href="https://pub.flutter-io.cn/packages/shared_preferences" target="_blank">最新的shared_preferences</a>
</p>
  </blockquote>

<p>截图:</p>
<!-- raw HTML omitted -->
<p><img src="images/%E5%AF%BC%E5%85%A5SharedPreferences%E5%BA%93.png" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>导入SharedPreferences库</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>更新包, 在终端中输入(或者点击IDE的更新包的按钮):</p>
<pre tabindex="0"><code>flutter packages get
</code></pre><p>运行项目:</p>
<!-- raw HTML omitted -->
<p><img src="images/%E8%BF%90%E8%A1%8CAPP1.png" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>运行APP1</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>现在, 我们可以正式进行数据存储的操作了!</p>
<h3 id="创建数据读写工具类">创建数据读写工具类</h3>
<p>实际项目中, 我们定会多次用到数据的读写, 所以封装一个工具类是比较明智的选择.</p>
<p>创建<code>./lib/shared_preferences_util.dart</code></p>
<h4 id="创建sharedpreferencesutil类">创建<code>SharedPreferencesUtil</code>类</h4>
<pre tabindex="0"><code>class SharedPreferencesUtil {
}
</code></pre><p>因为后面要用到SharedPreferences, 所以导入shared_preferences:</p>
<pre tabindex="0"><code>import &#39;package:shared_preferences/shared_preferences.dart&#39;;
</code></pre><h4 id="数据存储函数-savedata">数据存储函数 <code>saveData()</code></h4>
<p>添加函数<code>saveData()</code>:</p>
<pre tabindex="0"><code>  /// 保存数据
  static saveData(String key, T value) async {
    SharedPreferences prefs = await SharedPreferences.getInstance();

    switch (T) {
      case String:
        prefs.setString(key, value as String);
        break;
      case int:
        prefs.setInt(key, value as int);
        break;
      case bool:
        prefs.setBool(key, value as bool);
        break;
      case double:
        prefs.setDouble(key, value as double);
        break;
    }
  }
</code></pre>


  <blockquote>
    <p>在定义函数时, 名称后面多了一个&quot;<code>&lt;T&gt;</code>&quot;, 这运用了泛型. 若对此有疑问, 请自行搜索&quot;dart 泛型&quot;的相关知识.</p>
<p>代码解析: 函数要求传入两个值, key以及value. key为我们要存的值的&quot;名字&quot;. 这个名字是唯一的, 后续我们在读取数据的时候也需要传入与这个key. value就是它对应的值. 函数体内, 我们先在首行引入一个SharedPreferences的实例, 便于后续使用. 使用<code>switch</code>分支, 用来判断传入的泛型类型. 判断完成后, 分别调用<code>prefs.setXXX(key, value)</code>, 完成数据存储.</p>
  </blockquote>

<!-- raw HTML omitted -->
<p><img src="images/SharedPreferencesUtil01.png" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>SharedPreferencesUtil01</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>代码截图:</p>
<h4 id="数据读取函数-getdata">数据读取函数 <code>getData()</code></h4>
<p>有数据存储函数, 自然也应该有与之对应的数据读取函数, 我们来写:</p>
<p>添加函数<code>getData()</code>:</p>
<pre tabindex="0"><code>  /// 读取数据
  static Future getData(String key) async {
    SharedPreferences prefs = await SharedPreferences.getInstance();

    T res;
    switch (T) {
      case String:
        res = prefs.getString(key) as T;
        break;
      case int:
        res = prefs.getInt(key) as T;
        break;
      case bool:
        res = prefs.getBool(key) as T;
        break;
      case double:
        res = prefs.getDouble(key) as T;
        break;
    }
    return res;
  }
</code></pre>


  <blockquote>
    <p>代码解析: 与上面的<code>saveData()</code>函数类似, 同样运用了泛型以及<code>switch</code>. 不同的是读取数据时调用的是<code>prefs.getXXX()</code></p>
  </blockquote>

<p>代码截图:</p>
<!-- raw HTML omitted -->
<p><img src="images/SharedPreferencesUtil02.png" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>SharedPreferencesUtil02</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->



  <blockquote>
    <p>到这里, 我们几乎已经完成了我们的教程. 反应快的同学应该已经可以直接使用了. 但是阿航的教程要保证其完整性, 让大家都会用, 并且理解为什么这么用. 我们来绘制APP界面, 更直观的测试!</p>
  </blockquote>

<h3 id="绘制用于测试工具类的简单界面">绘制用于测试工具类的简单界面</h3>
<p>回到<code>./lib/main.dart</code>, 我们来增加几个按钮和输入框.</p>
<h4 id="导入sharedpreferencesutil">导入<code>SharedPreferencesUtil</code></h4>
<p>先导入<code>SharedPreferencesUtil</code>方便后续使用:</p>
<pre tabindex="0"><code>import &#39;package:my_shared_preferences_demo/shared_preferences_util.dart&#39;;
</code></pre><h4 id="定义实例变量">定义实例变量</h4>
<p>在<code>_MyHomePageState</code>定义实例变量<code>_savedValue</code>和<code>_currentInputValue</code>, 用于记录存储及当前输入的值:</p>
<pre tabindex="0"><code>  // 保存的值
  String _savedValue = &#34;加载中..&#34;;

  // 当前输入的值
  String _currentInputValue;
</code></pre><h4 id="初始化页面时加载数据">初始化页面时加载数据.</h4>
<p>定义<code>initState()</code>, 在初始化页面时读取已存的数据</p>
<pre tabindex="0"><code>  @override
  void initState() {
    super.initState();
    SharedPreferencesUtil.getData(&#34;myData&#34;).then((value) {
      setState(() {
        _savedValue = value;
      });
    });
  }
</code></pre>


  <blockquote>
    <p>代码解析: 可以看到<code>initState()</code>上有<code>@override</code>, 因为<code>initState()</code>为继承过来的函数. 函数内部先调用<code>super.initState()</code>. 接下来就是通过此前定义的<code>SharedPreferencesUtil</code>获取存储的数据. 因为<code>shared_preferences</code>提供的函数是<code>async</code>(异步)的, 所以需要通过<code>.then()</code>来保证其获取到数据后再进行后续操作. 获取到value后, 存至_savedValue.</p>
  </blockquote>

<p>接下来就是绘制界面了, 在<code>build</code>-&gt;<code>Scaffold</code>-&gt;<code>body:Center</code>-&gt;<code>child: Column</code>-&gt;<code>children</code>中添加以下代码块:</p>
<pre tabindex="0"><code>// 用于显示数据的Text
Text(
  _savedValue == null ? &#34;无数据&#34; : _savedValue,
  style: TextStyle(fontSize: 60, fontWeight: FontWeight.bold),
),
// 用于修改数据的输入框
TextField(
  onChanged: (value) {
    _currentInputValue = value;
  },
  // 仅为美观, 增加输入框的边框
  decoration: InputDecoration(
      contentPadding: EdgeInsets.all(10.0),
      border: OutlineInputBorder(
        borderRadius: BorderRadius.circular(15.0),
      )),
),
Row(
  mainAxisAlignment: MainAxisAlignment.center,
  children: [
    // 用于触发保存数据的按钮
    RaisedButton(
      child: Text(&#34;保存&#34;),
      onPressed: () {
        // 当点击按钮时, 调用存储数据的函数
        SharedPreferencesUtil.saveData(
            &#34;myData&#34;, _currentInputValue);

        // 同时渲染当前显示的保存的值
        setState(() {
          _savedValue = _currentInputValue;
        });
      },
    ),
    RaisedButton(
      child: Text(&#34;清空数据&#34;),
      onPressed: () {
        // 当点击按钮时, 调用存储数据的函数
        SharedPreferencesUtil.saveData(&#34;myData&#34;, null);

        // 同时渲染当前显示的保存的值
        setState(() {
          _savedValue = &#34;无数据&#34;;
        });
      },
    )
  ],
),
</code></pre>


  <blockquote>
    <p>代码解析: 这里虽然看起来代码多一点, 实质上只有1个输入框和2个按钮. 里面没有特别复杂的逻辑, 所有说明都在代码注释中, 可自行查看.</p>
  </blockquote>

<p>以上的代码截图:</p>
<!-- raw HTML omitted -->
<p><img src="images/%E7%BB%98%E5%88%B6%E7%95%8C%E9%9D%A2%E4%BB%A3%E7%A0%81%E6%88%AA%E5%9B%BE.png" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>绘制界面代码截图</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="大功告成">大功告成</h2>
<p>若你的代码没有问题, 运行项目, 效果应该是这样的:</p>
<!-- raw HTML omitted -->
<p><img src="images/SharedPreferences%E6%9C%80%E7%BB%88%E6%95%88%E6%9E%9C-1.gif" alt="Flutter 数据存储 SharedPreferences"></p>
<!-- raw HTML omitted -->
<p>SharedPreferences 最终效果</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>通过以上的一些步骤, 我们终于完成了 Flutter 数据存储 之 SharedPreference , 是不是很简单?</p>
<h2 id="仓库地址-1">仓库地址　</h2>
<p>所有源码(含注释)均已上传至开源仓库:</p>
<ul>
<li><a href="https://github.com/HarrisonQi/flutter-actual-combat-demo/tree/master/my_shared_preferences_demo" target="_blank">Github</a>
</li>
<li><a href="https://gitee.com/HarrisonQI/flutter-actual-combat-demo/tree/master/my_shared_preferences_demo" target="_blank">码云</a>
</li>
</ul>
<p>对文章若有任何问题、异议以及改进建议, 欢迎在下方进行评论. 作者将尽快回复! 若图片展示异常, 欢迎阅读<a href="https://blog.bugcatt.com/archives/165" target="_blank">官方博客</a>
.</p>
<p>更多更好的教程/博客/资讯, 欢迎访问我的官网: <a href="https://blog.bugcatt.com" target="_blank">阿航的技术小站</a>
.</p>


        
      </section>

      

      
    </article>
  </div>

  <div class="hidden lg:flex lg:flex-col lg:items-end">
    
  </div>
</div>


            
<footer class="flex justify-between items-center gap-2 px-4 py-12">

  <div>
  
  <p>© 2025 阿航的技术小站</p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
        <div class="back">
          <div class="container">
            
            <div class="dream-grid dream-grid-about">
  

  

  
</div>

            

            
<footer class="flex justify-between items-center gap-2 px-4 py-12">

  <div>
  
  <p>© 2025 阿航的技术小站</p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
      </div>
    </div>

    <script>
  window.lightTheme =  null 
  window.darkTheme =  null 
</script>


  <script src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>

  
  
  <script src="/js/grid.js"></script>




<script src="/js/main.js"></script>

    









    

    

    

    

    <script type="module" src="https://unpkg.com/ionicons@7.4.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.4.0/dist/ionicons/ionicons.js"></script>
  </body>
</html>
